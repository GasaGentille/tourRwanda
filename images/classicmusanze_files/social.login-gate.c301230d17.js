($WP="undefined"!=typeof $WP?$WP:[]).push({id:"@ta/social.login-gate",d:["vendor-babel","vendor-react-libs","vendor-redux-libs","lithium-platform","@ta/social.failover","vendor-apollo-libs","ta-platform","@ta/common.webview","@ta/tracking.interactions","@ta/overlays.fullscreen-overlay","@ta/overlays.managers","@ta/overlays.pieces","@ta/events.keyboard-event-listener"],e:["./packages/social/login-gate/index.jsx"],x:{"./packages/social/login-gate/AuthGated.jsx":["a"],"./packages/social/login-gate/index.jsx":["SocialLoginGate","MemberHardGate","TermsOfUseOverlay","SocialOpener","AuthGated","TermsOverlayQuery"]},m:{"./node_modules/webpack/buildin/global.js":function(e,n){var t;t=function(){return this}();try{t=t||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(t=window)}e.exports=t},"./packages/social/login-gate/AuthGated.jsx":function(e,n,t){"use strict";(function(e){var r=t("@babel/runtime/helpers/esm/objectSpread"),a=t.n(r),o=t("@babel/runtime/helpers/esm/classCallCheck"),l=t.n(o),i=t("@babel/runtime/helpers/esm/createClass"),s=t.n(i),c=t("@babel/runtime/helpers/esm/possibleConstructorReturn"),u=t.n(c),d=t("@babel/runtime/helpers/esm/getPrototypeOf"),m=t.n(d),f=t("@babel/runtime/helpers/esm/inherits"),v=t.n(f),p=t("@babel/runtime/helpers/esm/defineProperty"),g=t.n(p),y=t("react"),O=t("react-redux"),b=t("react-apollo"),h=t("@ta/common.routing"),k=t("@ta/common.webview"),E=t("@ta/tracking.interactions"),w=function(n){function t(){return l()(this,t),u()(this,m()(t).apply(this,arguments))}return v()(t,n),s()(t,[{key:"formatInteraction",value:function e(n){var t=this.props.tracking;return t?{variables:{interaction:g()({},t.source,g()({},n,a()({element:t.element},t.attributes||{})))}}:null}},{key:"renderInner",value:function n(t,r){var a=this.props,o=a.loggedInUserId,l=a.pid,i=a.flowOrigin,s=a.flow,c=a.extraQueryParams,u=a.onClose,d=a.children,m=a.closeX,f=a.closeOnDocClick,v=a.windowShadeOption;return d(function n(a){return new Promise(function(n){if(o)n();else if(k.NativeBridge.isNativeWebview())k.NativeBridge.showRegistration(!1);else{var d={flow:s||"CORE_COMBINED",pid:a||l||-1,userRequestedForce:!0,extraQueryParams:c||{},locationId:r||-1,onSuccess:function e(r){t("modalSuccess"),n(r)},onClose:u,closeX:m,closeOnDocClick:f,windowShadeOption:v};i&&(d.extraQueryParams.flowOrigin=i),e.require(["trjs!ta/registration/RegOverlay"],function(e){t("elementClick"),e.showRegOverlayByPageModel(null,null,window.require("page-model"),d)})}})},o)}},{key:"render",value:function e(){var n=this;return y.createElement(h.RouteConsumer,null,function(e){var t=e.route;return y.createElement(b.Mutation,{mutation:E.LogInteractionV4},function(e){return n.renderInner(function t(r){var a=n.formatInteraction(r);a&&e(a)},t.geo)})})}}]),t}(y.Component);g()(w,"defaultProps",{closeX:!0,closeOnDocClick:!0,windowShadeOption:"dark"}),n.a=Object(O.connect)(function(e){return{loggedInUserId:e.auth.loggedInUserId}})(w)}).call(this,t("./node_modules/webpack/buildin/global.js"))},"./packages/social/login-gate/index.jsx":function(e,n,t){"use strict";t.r(n);var r=t("@babel/runtime/helpers/esm/classCallCheck"),a=t.n(r),o=t("@babel/runtime/helpers/esm/createClass"),l=t.n(o),i=t("@babel/runtime/helpers/esm/possibleConstructorReturn"),s=t.n(i),c=t("@babel/runtime/helpers/esm/getPrototypeOf"),u=t.n(c),d=t("@babel/runtime/helpers/esm/inherits"),m=t.n(d),f=t("@babel/runtime/helpers/esm/assertThisInitialized"),v=t.n(f),p=t("@babel/runtime/helpers/esm/defineProperty"),g=t.n(p),y=t("react"),O=t("react-redux"),b=t("@ta/common.features"),h=t("@ta/social.failover"),k=t("./packages/social/login-gate/AuthGated.jsx"),E=t("react-apollo"),w=t("@ta/common.logging"),S=t.n(w),C=t("@ta/overlays.fullscreen-overlay"),P=t.n(C),T=t("@ta/overlays.managers"),U=t("@ta/overlays.pieces"),_=t("@ta/platform.import"),I={kind:"Document",definitions:[{kind:"OperationDefinition",operation:"query",name:{kind:"Name",value:"TermsOverlay"},variableDefinitions:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"insightProfile"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"uiCardsState"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"states"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"id"},arguments:[],directives:[]},{kind:"Field",name:{kind:"Name",value:"state"},arguments:[],directives:[]}]}}]}}]}},{kind:"Field",name:{kind:"Name",value:"getTermOfUseAcceptanceInfo"},arguments:[],directives:[],selectionSet:{kind:"SelectionSet",selections:[{kind:"Field",name:{kind:"Name",value:"accepted"},arguments:[],directives:[]}]}}]}}],loc:{start:0,end:167}};I.loc.source={body:"34460b78ddd8"};var R=I,M={position:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},j=Object(_.deferredImport)("@ta/social.confirm-username","ConfirmUsername"),x=function e(n){var t=n.onComplete,r=n.children;return y.createElement(E.Query,{query:R},function(e){var n=e.loading,a=e.data,o=e.error;if(n)return null;if(a){var l=a.getTermOfUseAcceptanceInfo&&a.getTermOfUseAcceptanceInfo.accepted,i=a.insightProfile&&a.insightProfile.uiCardsState;return l&&i&&function e(n){return n.states.find(function(e){return"ONBOARDING_CONFIRM_USER"===e.id&&"COMPLETED"===e.state})}(i)?(t(),null):r}return o&&S.a.warn("Error in SkipIfCompleted query: ".concat(o)),S.a.warn("TermsOfUseOverlay was shown due to lack of sufficient information or a query error."),r})},N=function e(n){var t=function e(t){return y.createElement("div",{className:"social-login-gate-TermsOfUseOverlay__container--2SESV"},y.createElement("div",{className:"social-login-gate-TermsOfUseOverlay__bodyContent--3eGDZ"},y.createElement(j,{onComplete:n.onComplete,closerForError:t,trackingModule:"Social_onboarding_gatedaction"})))},r=function e(){return y.createElement(T.Closer,null,function(e){var r=function t(){e(),n.onClose&&n.onClose()};return n.fullscreen?y.createElement(y.Fragment,null,y.createElement(P.a,null,t(r))):y.createElement(y.Fragment,null,y.createElement(U.BlockScroll,null),y.createElement(U.Backdrop,{close:function e(){}},y.createElement(U.Overlay,M,t(r))))})};return n.forceTermsOfUse?y.createElement(r,null):y.createElement(x,{onComplete:n.onComplete},y.createElement(r,null))};N.defaultProps={fullscreen:!1,onClose:void 0,forceTermsOfUse:!1};var F=Object(O.connect)(function(e,n){return{fullscreen:n.fullscreenAlways||"MOBILE"===e.meta.device.viewportCategory}})(N),A=t("@ta/events.keyboard-event-listener"),B=t.n(A),D={position:{position:"fixed",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},G=function e(n){var t=y.createElement("div",{className:"social-login-gate-ReadonlyMessageOverlay__container--1l9mx"},y.createElement("div",{className:"social-login-gate-ReadonlyMessageOverlay__bodyContent--1bBv0"},n.children),y.createElement(U.CloseX,{close:n.closer}));return n.fullscreen?y.createElement(y.Fragment,null,y.createElement(P.a,null,t)):y.createElement(y.Fragment,null,y.createElement(U.BlockScroll,null),y.createElement(U.Backdrop,{close:n.closer},y.createElement(U.Overlay,D,t),y.createElement(B.a,{keyName:"Escape",callback:n.closer})))};G.defaultProps={fullscreen:!1};var L=Object(O.connect)(function(e,n){return{fullscreen:n.fullscreenAlways||"MOBILE"===e.meta.device.viewportCategory}})(G),q=function(e){function n(){var e,t;a()(this,n);for(var r=arguments.length,o=new Array(r),l=0;l<r;l++)o[l]=arguments[l];return t=s()(this,(e=u()(n)).call.apply(e,[this].concat(o))),g()(v()(v()(t)),"state",{openTermsOfUseOverlay:!1,onSuccess:function e(){},forceTermsOfUse:!1,openReadonlyOverlay:!1}),g()(v()(v()(t)),"closeTermsOfUseOverlay",function(){t.setState({openTermsOfUseOverlay:!1,onSuccess:function e(){}})}),g()(v()(v()(t)),"openReadonlyOverlay",function(){t.setState({openReadonlyOverlay:!0})}),g()(v()(v()(t)),"closeReadonlyOverlay",function(){t.setState({openReadonlyOverlay:!1})}),t}return m()(n,e),l()(n,[{key:"render",value:function e(){var n=this,t=this.props,r=t.pid,a=t.flowOrigin,o=t.flow,l=t.children,i=t.onClose,s=t.onLoginSuccess,c=t.tracking,u=t.isReadonlyMode;return y.createElement(k.a,{pid:r,flowOrigin:a,flow:o,extraQueryParams:{social:!0},onClose:i,tracking:c},function(e,t){var r=u?function e(){return n.openReadonlyOverlay(),Promise.reject()}:Object(b.featureIsEnabled)("social_2018_login_gate")?function t(r){return e(r).then(function(e){s&&s();var t=e&&(e.hasCreatedMember||!e.hasAcceptedTermsOfUse);return e&&!t||Object(b.featureIsEnabled)("social_2018_login_gate_skip_terms_of_service")?Promise.resolve():new Promise(function(e){n.setState({openTermsOfUseOverlay:!0,forceTermsOfUse:t,onSuccess:function t(){e(),n.setState({openTermsOfUseOverlay:!1,onSuccess:function e(){}})}})})})}:function e(){return Promise.resolve()};return y.createElement(y.Fragment,null,l(r,t),n.state.openTermsOfUseOverlay&&y.createElement(F,{onComplete:n.state.onSuccess,forceTermsOfUse:n.state.forceTermsOfUse,onClose:n.closeTermsOfUseOverlay}),n.state.openReadonlyOverlay&&y.createElement(L,{closer:n.closeReadonlyOverlay},y.createElement(h.FailoverMessage,null)))})}}]),n}(y.Component);g()(q,"defaultProps",{pid:-1,flowOrigin:void 0,flow:void 0,tracking:void 0,onLoginSuccess:void 0});var Q=Object(O.connect)(function(e){return{isReadonlyMode:e.meta.readonlyMode}})(q),X=function(e){function n(){return a()(this,n),s()(this,u()(n).apply(this,arguments))}return m()(n,e),l()(n,[{key:"render",value:function e(){var n=this.props,t=n.pid,r=n.flowOrigin,a=n.flow,o=n.onLoginSuccess,l=n.tracking;return!this.props.isReadonlyMode&&y.createElement(k.a,{pid:t,flowOrigin:r,flow:a,tracking:l,closeX:!1,closeOnDocClick:!1,windowShadeOption:"light"},function(e){return e().then(function(){return o&&o(),Promise.resolve()}),y.createElement(y.Fragment,null)})}}]),n}(y.Component);g()(X,"defaultProps",{pid:-1,flowOrigin:"join",flow:"MEMBER_GATE_COMBINED",tracking:void 0,onLoginSuccess:void 0});var W=Object(O.connect)(function(e){return{isReadonlyMode:e.meta.readonlyMode}})(X),$=function e(n){var t=n.name,r=n.local,a=n.pid,o=n.children;return y.createElement(Q,{pid:a},function(e){return y.createElement(T.Opener,{name:t,local:r},function(n,t){return o(function(){e().then(n)},t)})})};$.defaultProps={local:!1,pid:void 0};var H=$;t.d(n,"SocialLoginGate",function(){return Q}),t.d(n,"MemberHardGate",function(){return W}),t.d(n,"TermsOfUseOverlay",function(){return F}),t.d(n,"SocialOpener",function(){return H}),t.d(n,"AuthGated",function(){return k.a}),t.d(n,"TermsOverlayQuery",function(){return R})}}});
//# sourceMappingURL=social.login-gate.c301230d17.js.map